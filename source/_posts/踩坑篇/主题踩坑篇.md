---
title: 前端到处是坑坑！
---
# hexo代码块样式调整 1



> ## `问题描述`
>
> - 代码显示在代码的头部，代码块body部分是空白的。
> - 代码块前面的三个不同颜色的小点被遮挡。
> - 代码块区域放大以后不能点返回箭头，否则页面卡住，必须刷新页面才能继续浏览。
> - 代码块的行号从头部开始显示。
>
> ## `解决方法`
>
> 1. 前四个问题我找了一天的答案，总是有瑕疵，终于，第二天中午的时候，我找到了，原来是主题配置的问题，所以啊，都是不认真看主题配置的原因，我用的是hexo中的shoka主题。主题配置里面有提到。**停用默认代码高亮功能，否则代码块的 mac 样式不能正常显示**。找到`highlight`和`prismjs`把`enable`改成`false`
>
> 2. 以下是我的代码：
>
>    ```yaml
>    highlight:
>      enable: false # 主题配置需要停用
>      auto_detect: true # 代码块高亮
>      line_number: true
>      tab_replace: ''
>      wrap: true
>      hljs: false
>      
>    prismjs:
>      enable: false # 主题配置需要停用
>      preprocess: true
>      line_number: true
>      tab_replace: ''
>    ```
>
>    

# hexo代码块样式调整 2

> ## `问题描述`
>
> - 代码块自动换行
> - 代码块前后有空白行问题
>
> ## `解决方法`
>
> 1. 找到`hexo-util/lib/highlight.js`文件，一般路径为`root/node_modules/hexo-util/lib/highlight.js`
>
> 2. 修改`highlight.js`中的代码，有些在`35~38`行处，有些在`91`行处，各有不同。
>
> 3. `修改前`
>
>    ```yaml
>    numbers += '<div class="line">' + (firstLine + i) + '</div>';
>    content += '<div class="line';
>    content += (mark.indexOf(firstLine + i) !== -1) ? ' marked' : '';
>    content += '">' + line + '</div>';
>    ```
>
> 4. `修改后`
>
>    ```yaml
>    numbers += '<span class="line">' + (firstLine + i) + '</span>\n';
>    content += '<span class="line';
>    content += (mark.indexOf(firstLine + i) !== -1) ? ' marked' : '';
>    content += '">' + line + '</span>\n';
>    
>    ```
>
>    
>
> 5. 总结：把里面的`div`标签换成`span`标签
>
>    

# 在Hexo插入本地图片

> ## `问题描述`
>
> - 图片显示不成功
> - 页面没反应，或者显示图片的地方只显示`alt`里面的类容
> - 或者成功以后打印出`no src attr skipped...`这类似的代码
>
> ## `解决方法`
>
> 1. 首先我们需要安装一个插件
>
>    ```yaml
>    npm install https://github.com/CodeFalling/hexo-asset-image --save
>    ```
>
>    `不要忘记修改配置文件`**post_asset_folder** 值为 **true**
>    
> 2. 由于本身的 asset-image 有 bug ，我们需要在 node_modules 中寻找到 hexo-asset-image 插件，修改 index.js 内容为以下：
>
>    ```js
>    'use strict';
>    var cheerio = require('cheerio');
>    
>    // http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string
>    function getPosition(str, m, i) {
>      return str.split(m, i).join(m).length;
>    }
>    
>    var version = String(hexo.version).split('.');
>    hexo.extend.filter.register('after_post_render', function(data){
>      var config = hexo.config;
>      if(config.post_asset_folder){
>        var link = data.permalink;
>    	if(version.length > 0 && Number(version[0]) == 3)
>    	   var beginPos = getPosition(link, '/', 1) + 1;
>    	else
>    	   var beginPos = getPosition(link, '/', 3) + 1;
>    	// In hexo 3.1.1, the permalink of "about" page is like ".../about/index.html".
>    	var endPos = link.lastIndexOf('/') + 1;
>        link = link.substring(beginPos, endPos);
>    
>        var toprocess = ['excerpt', 'more', 'content'];
>        for(var i = 0; i < toprocess.length; i++){
>          var key = toprocess[i];
>     
>          var $ = cheerio.load(data[key], {
>            ignoreWhitespace: false,
>            xmlMode: false,
>            lowerCaseTags: false,
>            decodeEntities: false
>          });
>    
>          $('img').each(function(){
>    		if ($(this).attr('src')){
>    		// For windows style path, we replace '\' to '/'.
>    		var src = $(this).attr('src').replace('\\', '/');
>    		if(!/http[s]*.*|\/\/.*/.test(src) &&
>    			!/^\s*\//.test(src)) {
>    			 // For "about" page, the first part of "src" can't be removed.
>    			 // In addition, to support multi-level local directory.
>    			 var linkArray = link.split('/').filter(function(elem){
>    				return elem != '';
>    			  });
>    			  var srcArray = src.split('/').filter(function(elem){
>    				return elem != '' && elem != '.';
>    			  });
>    			  if(srcArray.length > 1)
>    				srcArray.shift();
>    			  src = srcArray.join('/');
>    			  $(this).attr('src', config.root + link + src);
>    			  console.info&&console.info("update link as:-->"+config.root + link + src);
>    			}
>    		}else{
>    	// 注释这两条打印是为了不报打印结果，不然你的命令窗口总会显示no src attr skipped...这类似的字样。
>    		//console.info&&console.info("no src attr, skipped...");
>    		//console.info&&console.info($(this));
>    		}
>          });
>          data[key] = $.html();
>        }
>      }
>    });
>    ```
>
> 3. 最后，打开_config.yml修改下述内容
>
>    ```yaml
>    # URL
>    ## If your site is put in a subdirectory, set url as 'http://example.com/child' and root as '/child/'
>    # url: http://example.com
>    url: https://XXXXX.github.io # 主要修改这里，把前面的XXXXX改为自己的github地址即可。
>    root: /
>    # permalink: :year/:month/:day/:title/
>    permalink: :title/
>    permalink_defaults:
>    ```
>
> 4. 总结，由于我用的是Typora编辑器，对于markdown来说，有很多编辑器，可能各不相同，在插入图片的时候我是直接QQ截图再需要放的地方直接`Ctrl`+`V`，这样的话，就会出现图片，上面会弹出将这个图片复制到。。。一般是在root/source/images（这个文件夹是自己新建的，以后写文章里面的插图，我都放在这里面）之下。除了这里，还有文章的相同路径下也会保存一张相同的图片，（这张图片可以删除，不影响渲染。）如果感觉有重复，就删掉文章之下的图片，这是它自动生成的。